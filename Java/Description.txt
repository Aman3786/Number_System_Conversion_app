This is the logic part of the part which is in java code.
